<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot cluster architectures as sequence logos. — plot_arch_for_clusters • seqArchR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot cluster architectures as sequence logos. — plot_arch_for_clusters"><meta property="og:description" content="Given a collection of FASTA sequences as a DNAStringSet object,
and the clusters information, this function plots the architectures for all
clusters. If a name for the PDF file is provided, the resulting set of
architecture sequence logos are saved as a multi-page PDF."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-67848084-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-67848084-3');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">seqArchR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.333</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/seqArchR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/snikumbh/seqArchR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot cluster architectures as sequence logos.</h1>
    <small class="dont-index">Source: <a href="https://github.com/snikumbh/seqArchR/blob/HEAD/R/plot_arch_for_clusters.R" class="external-link"><code>R/plot_arch_for_clusters.R</code></a></small>
    <div class="hidden name"><code>plot_arch_for_clusters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given a collection of FASTA sequences as a DNAStringSet object,
and the clusters information, this function plots the architectures for all
clusters. If a name for the PDF file is provided, the resulting set of
architecture sequence logos are saved as a multi-page PDF.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plot_arch_for_clusters</span><span class="op">(</span>
  <span class="va">seqs</span>,
  <span class="va">clust_list</span>,
  pos_lab <span class="op">=</span> <span class="cn">NULL</span>,
  xt_freq <span class="op">=</span> <span class="fl">5</span>,
  set_titles <span class="op">=</span> <span class="cn">TRUE</span>,
  pdf_width <span class="op">=</span> <span class="fl">11</span>,
  pdf_height <span class="op">=</span> <span class="fl">2</span>,
  pdf_name <span class="op">=</span> <span class="cn">NULL</span>,
  show <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>seqs</dt>
<dd><p>Sequences as a <code><a href="https://rdrr.io/pkg/Biostrings/man/XStringSet-class.html" class="external-link">DNAStringSet</a></code>.</p></dd>
<dt>clust_list</dt>
<dd><p>Clusters as a list of sequence IDs in each cluster.</p></dd>
<dt>pos_lab</dt>
<dd><p>Labels for sequence positions, should be of same
length as that of the sequences. Default value is NULL, when the
positions are labeled from 1 to the length of the sequences.</p></dd>
<dt>xt_freq</dt>
<dd><p>Frequency of x-axis ticks.</p></dd>
<dt>set_titles</dt>
<dd><p>Specify TRUE if titles are to be written for the plots.
With FALSE, there are no titles for the plots. The title for each plot
includes the current cluster number, total number of clusters, start and
end sequence numbers in the collection.</p></dd>
<dt>pdf_width, pdf_height</dt>
<dd><p>Width and height in inches of the PDF file.
Default values are 11 and 2.</p></dd>
<dt>pdf_name</dt>
<dd><p>Specify the PDF filename.</p></dd>
<dt>show</dt>
<dd><p>Set TRUE if plot should be immediately shown/plotted. Default is
TRUE. By setting FALSE, one can simply collect the list of plots and use
any other approach to arrange/display them. See examples.</p></dd>
<dt>...</dt>
<dd><p>Additional args passed to <code><a href="plot_ggseqlogo_of_seqs.html">plot_ggseqlogo_of_seqs</a></code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of (ggplot2-based) sequence logo plots is returned. When a
valid file name is specified, the list of plots is also written to the PDF
file (one plot per page).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_seqArchRresult.rds"</span>,</span>
<span class="r-in">         package <span class="op">=</span> <span class="st">"seqArchR"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Default position labels 1 to length of the sequences.</span></span>
<span class="r-in"><span class="co"># Can also set pos_lab based on biology, e.g., use -50 to 49 denoting</span></span>
<span class="r-in"><span class="co"># 50 basepairs upstream and 49 downstream of the transcription start site</span></span>
<span class="r-in"><span class="co"># located at position 0.</span></span>
<span class="r-in"><span class="va">arch_pl</span> <span class="op">&lt;-</span> <span class="fu">plot_arch_for_clusters</span><span class="op">(</span>seqs <span class="op">=</span> <span class="fu"><a href="seqs_str.html">seqs_str</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>,</span>
<span class="r-in">                                  clust_list <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">clustSol</span><span class="op">$</span><span class="va">clusters</span>,</span>
<span class="r-in">                                  pos_lab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span class="r-in">                                  pdf_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span class="r-in">                                  fixed_coord <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; = "none")` instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plot title:(1/3) Arch '1': 100 sequences (1-100)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; = "none")` instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plot title:(2/3) Arch '2': 50 sequences (101-150)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; = "none")` instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Coordinate system already present. Adding new coordinate system, which will replace the existing one.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plot title:(3/3) Arch '3': 50 sequences (151-200)</span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Using cowplot::plot_grid</span></span>
<span class="r-in"><span class="va">arch_pl</span> <span class="op">&lt;-</span> <span class="fu">plot_arch_for_clusters</span><span class="op">(</span>seqs <span class="op">=</span> <span class="fu"><a href="seqs_str.html">seqs_str</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>,</span>
<span class="r-in">                                  clust_list <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">clustSol</span><span class="op">$</span><span class="va">clusters</span>,</span>
<span class="r-in">                                  pos_lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,</span>
<span class="r-in">                                  method <span class="op">=</span> <span class="st">"bits"</span>,</span>
<span class="r-in">                                  pdf_name <span class="op">=</span> <span class="cn">NULL</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; = "none")` instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plot title:(1/3) Arch '1': 100 sequences (1-100)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; = "none")` instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plot title:(2/3) Arch '2': 50 sequences (101-150)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; = "none")` instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plot title:(3/3) Arch '3': 50 sequences (151-200)</span>
<span class="r-in"><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">arch_pl</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_arch_for_clusters-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plotting architecture sequence logos with probability instead of</span></span>
<span class="r-in"><span class="co"># information content</span></span>
<span class="r-in"><span class="va">arch_pl</span> <span class="op">&lt;-</span> <span class="fu">plot_arch_for_clusters</span><span class="op">(</span>seqs <span class="op">=</span> <span class="fu"><a href="seqs_str.html">seqs_str</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>,</span>
<span class="r-in">                                  clust_list <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">clustSol</span><span class="op">$</span><span class="va">clusters</span>,</span>
<span class="r-in">                                  pos_lab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,</span>
<span class="r-in">                                  method <span class="op">=</span> <span class="st">"prob"</span>,</span>
<span class="r-in">                                  pdf_name <span class="op">=</span> <span class="cn">NULL</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; = "none")` instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plot title:(1/3) Arch '1': 100 sequences (1-100)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; = "none")` instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plot title:(2/3) Arch '2': 50 sequences (101-150)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; = "none")` instead.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> replace the existing scale.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plot title:(3/3) Arch '3': 50 sequences (151-200)</span>
<span class="r-in"><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">arch_pl</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_arch_for_clusters-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sarvesh Nikumbh.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

